suite: helm_lib_module_pod_security_context definition
templates:
  - helm_lib_module_pod_security_context.yaml
tests:
  - it: should render pod security context custom
    documentIndex: 0
    asserts:
      - equal:
          path: securityContext
          value:
            runAsNonRoot: true
            runAsUser: 1000
            runAsGroup: 1000
  - it: should render pod security context nobody
    documentIndex: 1
    asserts:
      - equal:
          path: securityContext
          value:
            runAsNonRoot: true
            runAsUser: 65534
            runAsGroup: 65534
  - it: should render pod security context nobody with writable fs
    documentIndex: 2
    asserts:
      - equal:
          path: securityContext
          value:
            runAsNonRoot: true
            runAsUser: 65534
            runAsGroup: 65534
            fsGroup: 65534
  - it: should render pod security context deckhouse
    documentIndex: 3
    asserts:
      - equal:
          path: securityContext
          value:
            runAsNonRoot: true
            runAsUser: 64535
            runAsGroup: 64535
  - it: should render pod security context deckhouse with writable fs
    documentIndex: 4
    asserts:
      - equal:
          path: securityContext
          value:
            runAsNonRoot: true
            runAsUser: 64535
            runAsGroup: 64535
            fsGroup: 64535
  - it: should render pod security context root
    documentIndex: 5
    asserts:
      - equal:
          path: securityContext
          value:
            runAsNonRoot: false
            runAsUser: 0
            runAsGroup: 0
  - it: should render pod security context runtime default
    documentIndex: 6
    asserts:
      - equal:
          path: securityContext
          value:
            seccompProfile:
              type: RuntimeDefault